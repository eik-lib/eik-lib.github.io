"use strict";(self.webpackChunkeik=self.webpackChunkeik||[]).push([[690],{9868:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>p,contentTitle:()=>o,default:()=>m,frontMatter:()=>i,metadata:()=>r,toc:()=>d});var s=t(4848),a=t(8453);const i={title:"Import maps"},o=void 0,r={id:"dependencies/import-maps",title:"Import maps",description:"Publishing shared dependencies and aliasing them helps nothing if application code doesn't use them. Import maps make it easier for developers to discover and use dependencies you publish to your Eik server.",source:"@site/docs/dependencies/import-maps.md",sourceDirName:"dependencies",slug:"/dependencies/import-maps",permalink:"/docs/dependencies/import-maps",draft:!1,unlisted:!1,editUrl:"https://github.com/eik-lib/eik-lib.github.io/tree/source/docs/docs/dependencies/import-maps.md",tags:[],version:"current",frontMatter:{title:"Import maps"},sidebar:"sidebar",previous:{title:"Package aliases",permalink:"/docs/dependencies/aliases"},next:{title:"Setting up an Eik server",permalink:"/docs/server/"}},p={},d=[{value:"Create an import map",id:"create-an-import-map",level:2},{value:"Publish the import map to Eik",id:"publish-the-import-map-to-eik",level:3},{value:"Create an alias for the import map",id:"create-an-alias-for-the-import-map",level:3},{value:"Update your import map",id:"update-your-import-map",level:2},{value:"Update an import map alias",id:"update-an-import-map-alias",level:3},{value:"Use your new import map",id:"use-your-new-import-map",level:2},{value:"How many import maps should you make?",id:"how-many-import-maps-should-you-make",level:2},{value:"Next steps",id:"next-steps",level:2}];function l(e){const n={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.p,{children:"Publishing shared dependencies and aliasing them helps nothing if application code doesn't use them. Import maps make it easier for developers to discover and use dependencies you publish to your Eik server."}),"\n",(0,s.jsxs)(n.p,{children:["A refresher from the ",(0,s.jsx)(n.a,{href:"/docs/introduction#import-mapping",children:"introduction"}),":"]}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"You can publish import maps to Eik in a similar way to dependencies and application code. Maps are versioned and immutable, and can be aliased in the same way other assets can."}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["Like how the ",(0,s.jsx)(n.code,{children:"npm"})," package type is designed for shared dependencies, ",(0,s.jsx)(n.code,{children:"map"})," is designed to hold your import maps."]}),"\n",(0,s.jsx)(n.h2,{id:"create-an-import-map",children:"Create an import map"}),"\n",(0,s.jsxs)(n.p,{children:["In the ",(0,s.jsx)(n.a,{href:"/docs/dependencies/aliases",children:"previous chapter"})," you made an alias for ",(0,s.jsx)(n.code,{children:"lodash"})," so applications can share the same major version and get automatic updates when the Eik alias is updated."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"https://eik.store.com/npm/lodash/v4/index.js\n"})}),"\n",(0,s.jsx)(n.p,{children:"Let's put that alias URL in an import map."}),"\n",(0,s.jsxs)(n.p,{children:["Eik import maps use the same syntax as ",(0,s.jsx)(n.a,{href:"https://developer.mozilla.org/en-US/docs/Web/HTML/Element/script/type/importmap",children:"import maps in the browser"}),", though without the ",(0,s.jsx)(n.code,{children:"<script>"})," tag."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n\t"imports": {\n\t\t"lodash": "https://eik.store.com/npm/lodash/v4/index.js"\n\t}\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:["Save that JSON to a file, for example ",(0,s.jsx)(n.code,{children:"map.json"}),"."]}),"\n",(0,s.jsx)(n.h3,{id:"publish-the-import-map-to-eik",children:"Publish the import map to Eik"}),"\n",(0,s.jsxs)(n.p,{children:["Open a terminal window, log in, and run the ",(0,s.jsx)(n.code,{children:"eik map"})," command."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"eik login --key YOUR_EIK_KEY --server https://eik.store.com\neik map store 1.0.0 ./map.json --server https://eik.store.com\n"})}),"\n",(0,s.jsxs)(n.p,{children:["You should now see the published import map at ",(0,s.jsx)(n.code,{children:"https://eik.store.com/map/store/1.0.0/"}),"."]}),"\n",(0,s.jsx)(n.h3,{id:"create-an-alias-for-the-import-map",children:"Create an alias for the import map"}),"\n",(0,s.jsx)(n.p,{children:"We encourage using aliases for import maps, similar to dependencies. That way an import map can be updated on Eik and new builds that use the import map get the updated map without changing their configuration."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"eik login --key YOUR_EIK_KEY --server https://eik.store.com\neik map-alias store 1.0.0 1 --server https://eik.store.com\n"})}),"\n",(0,s.jsxs)(n.p,{children:["After running the ",(0,s.jsx)(n.code,{children:"map-alias"})," command you should see the import map at ",(0,s.jsx)(n.code,{children:"https://eik.store.com/map/store/v1/"}),"."]}),"\n",(0,s.jsx)(n.h2,{id:"update-your-import-map",children:"Update your import map"}),"\n",(0,s.jsx)(n.p,{children:"Say you add a new dependency and want to include it in the import map. The workflow is similar to when you first created the import map."}),"\n",(0,s.jsxs)(n.p,{children:["Update ",(0,s.jsx)(n.code,{children:"map.json"})," to include the new mapping."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n\t"imports": {\n\t\t"date-fns": "https://eik.store.com/npm/date-fns/v3/index.js",\n\t\t"lodash": "https://eik.store.com/npm/lodash/v4/index.js"\n\t}\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:"Publish the map under a new version number."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"eik login --key YOUR_EIK_KEY --server https://eik.store.com\neik map store 1.1.0 ./map.json --server https://eik.store.com\n"})}),"\n",(0,s.jsx)(n.h3,{id:"update-an-import-map-alias",children:"Update an import map alias"}),"\n",(0,s.jsx)(n.p,{children:"With a new version of the map it's time to update the alias. The command is the same as before, only with an updated version number."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"eik login --key YOUR_EIK_KEY --server https://eik.store.com\neik map-alias store 1.1.0 1 --server https://eik.store.com\n"})}),"\n",(0,s.jsx)(n.h2,{id:"use-your-new-import-map",children:"Use your new import map"}),"\n",(0,s.jsxs)(n.p,{children:["Applications can now update their ",(0,s.jsx)(n.code,{children:"eik.json"})," config to use the new import map. As long as their build tool is configured with an Eik plugin, that plugin will handle fetching the import map from the server and do the proper import mapping at build-time. Check out the Guides section for several examples."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n\t"name": "my-app",\n\t"version": "1.0.0",\n\t"server": "https://eik.store.com",\n\t"files": "./public",\n\t"import-map": ["https://eik.store.com/map/store/v1"]\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"how-many-import-maps-should-you-make",children:"How many import maps should you make?"}),"\n",(0,s.jsx)(n.p,{children:"Should you have one import for all your shared dependencies, or should you have several? That's up to you."}),"\n",(0,s.jsx)(n.p,{children:"Import maps are versioned and can be aliased the same as any other asset on Eik. If you need to update a major version of a dependency you can create a new major version of the import map. However, updating a major version of a map means your users have to update their configuration."}),"\n",(0,s.jsx)(n.p,{children:"If you have a dependency that's only used by a subset of your applications, consider having a separate import map for that dependency and its ecosystem of related modules. That way any major changes in that import map don't needlessly affect applications that don't use that dependency."}),"\n",(0,s.jsx)(n.p,{children:"Taken to its extreme, you could make an import map for each dependency. However, at that point developers could just as well configure their builds to use the package aliases directly, skipping the import maps entirely."}),"\n",(0,s.jsx)(n.h2,{id:"next-steps",children:"Next steps"}),"\n",(0,s.jsx)(n.p,{children:"You've now covered all the different assets and aliases on Eik:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Application packages"}),"\n",(0,s.jsx)(n.li,{children:"Shared npm packages"}),"\n",(0,s.jsx)(n.li,{children:"Import maps"}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["Now it's time to point application developers to the ",(0,s.jsx)(n.a,{href:"/docs/introduction/workflow",children:"Getting started guide"})," and let them know they should use your new import map."]})]})}function m(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>r});var s=t(6540);const a={},i=s.createContext(a);function o(e){const n=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:o(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);