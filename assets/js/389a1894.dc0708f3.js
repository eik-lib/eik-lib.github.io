"use strict";(self.webpackChunkeik=self.webpackChunkeik||[]).push([[6150],{3905:function(e,t,n){n.d(t,{Zo:function(){return u},kt:function(){return d}});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var o=a.createContext({}),s=function(e){var t=a.useContext(o),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},u=function(e){var t=s(e.components);return a.createElement(o.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},c=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,o=e.parentName,u=p(e,["components","mdxType","originalType","parentName"]),c=s(n),d=r,k=c["".concat(o,".").concat(d)]||c[d]||m[d]||i;return n?a.createElement(k,l(l({ref:t},u),{},{components:n})):a.createElement(k,l({ref:t},u))}));function d(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,l=new Array(i);l[0]=c;var p={};for(var o in t)hasOwnProperty.call(t,o)&&(p[o]=t[o]);p.originalType=e,p.mdxType="string"==typeof e?e:r,l[1]=p;for(var s=2;s<i;s++)l[s]=n[s];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}c.displayName="MDXCreateElement"},1683:function(e,t,n){n.r(t),n.d(t,{assets:function(){return u},contentTitle:function(){return o},default:function(){return d},frontMatter:function(){return p},metadata:function(){return s},toc:function(){return m}});var a=n(7462),r=n(3366),i=(n(7294),n(3905)),l=["components"],p={id:"client_putting_it_all_together",title:"Putting It All Together",sidebar_label:"Putting It All Together"},o=void 0,s={unversionedId:"client_putting_it_all_together",id:"client_putting_it_all_together",title:"Putting It All Together",description:"Aliases can be used with application packages, NPM packages and import maps to make it easier to update versions without the need to update and redeploy applications.",source:"@site/docs/client_putting_it_all_together.md",sourceDirName:".",slug:"/client_putting_it_all_together",permalink:"/docs/client_putting_it_all_together",tags:[],version:"current",frontMatter:{id:"client_putting_it_all_together",title:"Putting It All Together",sidebar_label:"Putting It All Together"},sidebar:"mainSidebar",previous:{title:"Aliases",permalink:"/docs/client_aliases"},next:{title:"Server",permalink:"/docs/server"}},u={},m=[{value:"Publish from NPM",id:"publish-from-npm",level:2},{value:"Alias NPM package",id:"alias-npm-package",level:2},{value:"Create an import map",id:"create-an-import-map",level:2},{value:"Alias import map",id:"alias-import-map",level:2},{value:"Update eik.json",id:"update-eikjson",level:2},{value:"Bundle local code (rollup example)",id:"bundle-local-code-rollup-example",level:2},{value:"publish bundled code to Eik server",id:"publish-bundled-code-to-eik-server",level:2},{value:"Consuming an application bundle",id:"consuming-an-application-bundle",level:2}],c={toc:m};function d(e){var t=e.components,n=(0,r.Z)(e,l);return(0,i.kt)("wrapper",(0,a.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"Aliases can be used with application packages, NPM packages and import maps to make it easier to update versions without the need to update and redeploy applications."),(0,i.kt)("p",null,"In the following example, the ",(0,i.kt)("inlineCode",{parentName:"p"},"@podium/browser")," package will be set up as a dependency that multiple pages bundles can include without the module being inlined (and therefore duplicated)."),(0,i.kt)("h2",{id:"publish-from-npm"},"Publish from NPM"),(0,i.kt)("p",null,"Publish an Eik mirror of the NPM package ",(0,i.kt)("inlineCode",{parentName:"p"},"@podium/browser"),". Eik installs a local copy of the module, bundles it into a single ESM friendly file and uploads it to an Eik server ready for use."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sh"},"eik npm @podium/browser 1.0.0-beta.2\n")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"@podium/browser")," should now be available at ",(0,i.kt)("inlineCode",{parentName:"p"},"https://myeikserver.com/npm/@podium/browser/1.0.0-beta.2/index.js")),(0,i.kt)("h2",{id:"alias-npm-package"},"Alias NPM package"),(0,i.kt)("p",null,"Create an alias pointing to the exact version of ",(0,i.kt)("inlineCode",{parentName:"p"},"@podium/browser")," that we published to Eik. In this case, ",(0,i.kt)("inlineCode",{parentName:"p"},"1.0.0-beta.2")," will be aliased to ",(0,i.kt)("inlineCode",{parentName:"p"},"v1"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sh"},"eik npm-alias @podium/browser 1.0.0-beta.2 1\n")),(0,i.kt)("p",null,"An alias for ",(0,i.kt)("inlineCode",{parentName:"p"},"@podium/browser")," should now be available at ",(0,i.kt)("inlineCode",{parentName:"p"},"https://myeikserver.com/npm/@podium/browser/v1/index.js")),(0,i.kt)("h2",{id:"create-an-import-map"},"Create an import map"),(0,i.kt)("p",null,"Create an import map JSON file that uses the ",(0,i.kt)("inlineCode",{parentName:"p"},"podium/browser")," alias ",(0,i.kt)("inlineCode",{parentName:"p"},"v1")," rather than the exact version so that if we need to update the module, it wont be necessary to update the import map."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "imports": {\n        "@podium/browser": "https://myeikserver.com/npm/@podium/browser/v1/index.js"\n    }\n}\n')),(0,i.kt)("p",null,"And then publish the import map to an Eik server"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sh"},"eik map my-map 1.0.0 ./import-map.json\n")),(0,i.kt)("p",null,"The import map should now be available at ",(0,i.kt)("inlineCode",{parentName:"p"},"https://myeikserver.com/map/my-map/1.0.0")),(0,i.kt)("h2",{id:"alias-import-map"},"Alias import map"),(0,i.kt)("p",null,"Create an alias of the import map for use when packaging application code."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sh"},"eik map-alias my-map 1.0.0 1\n")),(0,i.kt)("p",null,"An alias for the import map ",(0,i.kt)("inlineCode",{parentName:"p"},"my-map")," version ",(0,i.kt)("inlineCode",{parentName:"p"},"1.0.0")," should now be available at ",(0,i.kt)("inlineCode",{parentName:"p"},"https://myeikserver.com/map/my-map/v1")),(0,i.kt)("h2",{id:"update-eikjson"},"Update eik.json"),(0,i.kt)("p",null,"Enter the import map alias URL in ",(0,i.kt)("inlineCode",{parentName:"p"},"eik.json")," so that plugins can use it to replace bare imports with Eik URLs."),(0,i.kt)("p",null,"eik.json"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "server": "https://myeikserver.com",\n    "name": "my-app",\n    "version": "1.0.0",\n    "files": {\n        "./esm.js": "./bundle.js",\n        "./esm.js.map": "./bundle.js.map",\n    },\n    "import-map": "https://myeikserver.com/map/my-map/v1"\n}\n')),(0,i.kt)("h2",{id:"bundle-local-code-rollup-example"},"Bundle local code (rollup example)"),(0,i.kt)("p",null,"This assumes you are already familiar with using Rollup and the instructions here only show how to augment an existing setup."),(0,i.kt)("p",null,"Add ",(0,i.kt)("inlineCode",{parentName:"p"},"@eik/rollup-plugin-import-map")," to your rollup config file"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sh"},"npm install -D @eik/rollup-plugin-import-map\n")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"import resolve from '@rollup/plugin-node-resolve';\nimport commonjs from '@rollup/plugin-commonjs';\nimport babel from '@rollup/plugin-babel';\nimport eik from '@eik/rollup-plugin-import-map';\n\nexport default {\n    input: './src/index.js',\n    output: {\n        file: './bundle.js',\n        format: 'es',\n        sourcemap: true,\n    },\n    plugins: [\n        eik(),\n        resolve(),\n        commonjs(),\n        babel(),\n    ],\n};\n")),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"n.b.")," The ",(0,i.kt)("inlineCode",{parentName:"p"},"js")," field in ",(0,i.kt)("inlineCode",{parentName:"p"},"eik.json")," is set to read ",(0,i.kt)("inlineCode",{parentName:"p"},"bundle.js")," which is produced by the rollup build."),(0,i.kt)("h2",{id:"publish-bundled-code-to-eik-server"},"publish bundled code to Eik server"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sh"},"eik package\n")),(0,i.kt)("h2",{id:"consuming-an-application-bundle"},"Consuming an application bundle"),(0,i.kt)("p",null,"The application bundle can be included in an HTML page using a script tag like so"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-html"},'<script src="https://myeikserver.com/pkg/my-app/1.0.0/esm.js" type="module" defer><\/script>\n')),(0,i.kt)("p",null,"Any bare references to ",(0,i.kt)("inlineCode",{parentName:"p"},"@podium/browser")," will have been replaced with absolute URLs to the Eik server."))}d.isMDXComponent=!0}}]);