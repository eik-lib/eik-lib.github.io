"use strict";(self.webpackChunkeik=self.webpackChunkeik||[]).push([[887],{7071:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>d,frontMatter:()=>t,metadata:()=>r,toc:()=>l});var i=a(4848),s=a(8453);const t={id:"overview_concepts",title:"Concepts",sidebar_label:"Concepts"},o=void 0,r={id:"overview_concepts",title:"Concepts",description:"Eik is for serving ESM and CSS but we use the term packages when we refer what is uploaded to an Eik server. A package can contain any set of files which are considered to be static assets on a web site. Despite being agnostic in its opinion about what a package can contain, Eik does have a package type definition which comes into play when organizing assets.",source:"@site/docs/overview_concepts.md",sourceDirName:".",slug:"/overview_concepts",permalink:"/docs/overview_concepts",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{id:"overview_concepts",title:"Concepts",sidebar_label:"Concepts"},sidebar:"mainSidebar",previous:{title:"Overview",permalink:"/docs/overview"},next:{title:"Workflow",permalink:"/docs/overview_workflow"}},c={},l=[{value:"Package Types",id:"package-types",level:2},{value:"Eik Packages",id:"eik-packages",level:3},{value:"NPM Packages",id:"npm-packages",level:3},{value:"Import Maps",id:"import-maps",level:3},{value:"Naming and versioning",id:"naming-and-versioning",level:2},{value:"Aliasing",id:"aliasing",level:2},{value:"Aliasing and versioning",id:"aliasing-and-versioning",level:3}];function h(e){const n={a:"a",code:"code",em:"em",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.p,{children:"Eik is for serving ESM and CSS but we use the term packages when we refer what is uploaded to an Eik server. A package can contain any set of files which are considered to be static assets on a web site. Despite being agnostic in its opinion about what a package can contain, Eik does have a package type definition which comes into play when organizing assets."}),"\n",(0,i.jsx)(n.h2,{id:"package-types",children:"Package Types"}),"\n",(0,i.jsx)(n.p,{children:"Eik differentiates between the types of packages it hosts. These are: Packages, NPM Packages and Import Maps. On the server, these different types live under separate URL namespaces to avoid conflicts with each other."}),"\n",(0,i.jsx)(n.h3,{id:"eik-packages",children:"Eik Packages"}),"\n",(0,i.jsx)(n.p,{children:"Eik packages are normally produced by websites and web applications. Such a package typically consists of bundled application code which, most of the time, does not really make much sense to publish as a module to a public repository such as NPM."}),"\n",(0,i.jsxs)(n.p,{children:["Packages live under the ",(0,i.jsx)(n.a,{href:"/docs/server_rest_api#packages",children:"/pkg/"})," namespace on an Eik server."]}),"\n",(0,i.jsx)(n.h3,{id:"npm-packages",children:"NPM Packages"}),"\n",(0,i.jsxs)(n.p,{children:["NPM packages are modules replicated from the ",(0,i.jsx)(n.a,{href:"https://www.npmjs.com/",children:"NPM repository"})," with the intention that they be loadable by browsers. This is similar to what ",(0,i.jsx)(n.a,{href:"https://unpkg.com/",children:"unpkg"})," and ",(0,i.jsx)(n.a,{href:"https://www.pika.dev/",children:"pika"})," do, with the exception that Eik does not proxy NPM modules as Unpkg and Pika do. Eik has taken a different approach and it is necessary to manually publish modules from NPM to Eik as well as do any transpiling from (for example) CommonJS to ESM as a manual process before publishing."]}),"\n",(0,i.jsxs)(n.p,{children:["NPM Packages live under the ",(0,i.jsx)(n.a,{href:"/docs/server_rest_api#npm-packages",children:"/npm/"})," namespace on an Eik server."]}),"\n",(0,i.jsx)(n.h3,{id:"import-maps",children:"Import Maps"}),"\n",(0,i.jsx)(n.p,{children:"Import Maps are handled as single JSON files in Eik and not treated as a package. It's only possible to upload a single file and not a group of files like it is when uploading packages."}),"\n",(0,i.jsxs)(n.p,{children:["Import Maps live under the ",(0,i.jsx)(n.a,{href:"/docs/server_rest_api#import-maps",children:"/map/"})," namespace on a Eik server."]}),"\n",(0,i.jsx)(n.h2,{id:"naming-and-versioning",children:"Naming and versioning"}),"\n",(0,i.jsxs)(n.p,{children:["A package intended to be published to an Eik server should follow the ",(0,i.jsx)(n.a,{href:"https://github.com/npm/validate-npm-package-name",children:"NPM module naming convention"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"package name length should be greater than zero"}),"\n",(0,i.jsx)(n.li,{children:"all characters in a package name must be lowercase i.e., no uppercase or mixed case names are allowed"}),"\n",(0,i.jsxs)(n.li,{children:["package name ",(0,i.jsx)(n.em,{children:"can"})," consist of hyphens"]}),"\n",(0,i.jsxs)(n.li,{children:["package name ",(0,i.jsx)(n.em,{children:"must not"})," contain non-url-safe characters (since name ends up being part of a URL)"]}),"\n",(0,i.jsxs)(n.li,{children:["package name ",(0,i.jsx)(n.em,{children:"should not"})," start with ",(0,i.jsx)(n.code,{children:"."})," or ",(0,i.jsx)(n.code,{children:"_"})]}),"\n",(0,i.jsxs)(n.li,{children:["package name ",(0,i.jsx)(n.em,{children:"should not"})," contain leading or trailing spaces"]}),"\n",(0,i.jsxs)(n.li,{children:["package name ",(0,i.jsx)(n.em,{children:"should not"})," contain any of the following characters: ",(0,i.jsx)(n.code,{children:"~)('!*"})]}),"\n",(0,i.jsxs)(n.li,{children:["package name ",(0,i.jsx)(n.em,{children:"cannot"})," be the same as a node.js/io.js core module nor a reserved/blacklisted name. For example, the following names are invalid:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"http"}),"\n",(0,i.jsx)(n.li,{children:"stream"}),"\n",(0,i.jsx)(n.li,{children:"node_modules"}),"\n",(0,i.jsx)(n.li,{children:"favicon.ico"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.li,{children:"package name length cannot exceed 214"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["All packages published to an Eik server is immutable and versioned with ",(0,i.jsx)(n.a,{href:"https://semver.org/",children:"Semantic Versioning"}),". This makes it possible to differentiate between what are considered smaller changes to a package which should not break behaviour in a dependency from changes which can be breaking."]}),"\n",(0,i.jsx)(n.p,{children:"Since packages are immutable, the Eik server will set an infinite HTTP cache control header on all files belonging to a package to make use of browser caching."}),"\n",(0,i.jsx)(n.h2,{id:"aliasing",children:"Aliasing"}),"\n",(0,i.jsx)(n.p,{children:"Aliasing can be applied to all packages and is a way of having a static URL reference, which can change, to a version of a package. Aliases are mutable and can be set to point to different versions of a package. The alias URL will do a redirect to the full version that it is set to point to."}),"\n",(0,i.jsxs)(n.p,{children:["Lets say we publish ",(0,i.jsx)(n.code,{children:"lit-html"}),"  version ",(0,i.jsx)(n.code,{children:"1.1.1"}),"  as an NPM package to an Eik server. It will then live on the following URL:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"https://eik-server.com/npm/lit-html/1.1.1/\n"})}),"\n",(0,i.jsx)(n.p,{children:"If we then create an alias for this version it will live on the following URL:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"https://eik-server.com/npm/lit-html/v1/\n"})}),"\n",(0,i.jsx)(n.p,{children:"Any request to any file under this alias will be redirected to the same path under the package version it refers too."}),"\n",(0,i.jsx)(n.p,{children:"A request to the following file under the alias:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"https://eik-server.com/npm/lit-html/v1/lit-html.js\n"})}),"\n",(0,i.jsx)(n.p,{children:"will redirect to:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"https://eik-server.com/npm/lit-html/1.1.1/lit-html.js\n"})}),"\n",(0,i.jsx)(n.p,{children:"Aliasing is not automatic in Eik. Aliases must be created or updated manually when a version of a package is published to an Eik server."}),"\n",(0,i.jsx)(n.h3,{id:"aliasing-and-versioning",children:"Aliasing and versioning"}),"\n",(0,i.jsxs)(n.p,{children:["Aliasing is tied to the semantic version of each package where the alias is the major version as a single digit pointing to a given full version of the same major version. That means that all 1.x versions of a package can have a ",(0,i.jsx)(n.code,{children:"v1"})," alias and all 2.x versions of the same package can have a ",(0,i.jsx)(n.code,{children:"v2"})," alias at the same time."]}),"\n",(0,i.jsxs)(n.p,{children:["This is a feature to make sure there is a way to publish breaking changes in a package without breaking its dependencies. In semantic versioning ",(0,i.jsx)(n.code,{children:"patch"})," and ",(0,i.jsx)(n.code,{children:"minor"})," versions are supposed to not contain breaking changes while a ",(0,i.jsx)(n.code,{children:"major"})," version can contain breaking changes so in a situation where a package introduces a breaking change it should, according to semantic versioning, be published as a new major version."]}),"\n",(0,i.jsxs)(n.p,{children:["This breaks a bit with what Eik is trying to solve if we look at the challenge we outlined in our ",(0,i.jsx)(n.a,{href:"/docs/overview#introduction",children:"introduction"})," but the handling of breaking changes is probably the one place where it's acceptable not to align all dependencies of a package to the same version of it."]})]})}function d(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},8453:(e,n,a)=>{a.d(n,{R:()=>o,x:()=>r});var i=a(6540);const s={},t=i.createContext(s);function o(e){const n=i.useContext(t);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);