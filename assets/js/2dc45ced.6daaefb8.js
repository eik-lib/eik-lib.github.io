"use strict";(self.webpackChunkeik=self.webpackChunkeik||[]).push([[739],{5347:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>c,contentTitle:()=>a,default:()=>u,frontMatter:()=>r,metadata:()=>o,toc:()=>l});var n=s(4848),i=s(8453);const r={id:"server",title:"Server",sidebar_label:"Server"},a=void 0,o={id:"server",title:"Server",description:"The Eik server is a node.js application distributed as the @eik/service NPM package. It aims to be runnable as a service out of the box but still be flexible and customizable enough to suite a wide range of infrastructures needs.",source:"@site/docs/server.md",sourceDirName:".",slug:"/server",permalink:"/docs/server",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{id:"server",title:"Server",sidebar_label:"Server"},sidebar:"mainSidebar",previous:{title:"Build Tool Plugins",permalink:"/docs/mapping_plugins"},next:{title:"Programatic API",permalink:"/docs/server_api"}},c={},l=[{value:"Overview",id:"overview",level:2},{value:"Customized setup",id:"customized-setup",level:2}];function d(e){const t={a:"a",code:"code",h2:"h2",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(t.p,{children:["The Eik server is a node.js application distributed as the ",(0,n.jsx)(t.a,{href:"https://www.npmjs.com/package/@eik/service",children:(0,n.jsx)(t.code,{children:"@eik/service"})})," NPM package. It aims to be runnable as a service out of the box but still be flexible and customizable enough to suite a wide range of infrastructures needs."]}),"\n",(0,n.jsxs)(t.p,{children:["The only pre-requirement to run the Eik server is ",(0,n.jsx)(t.a,{href:"https://nodejs.org/",children:"node.js 12.x or newer"}),"."]}),"\n",(0,n.jsx)(t.p,{children:"The fastest way to get a running instance of the Eik server is by using NPX:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-sh",children:"npx @eik/service\n"})}),"\n",(0,n.jsxs)(t.p,{children:["This will install the latest Eik server and start it at ",(0,n.jsx)(t.a,{href:"http://localhost:4001",children:"http://localhost:4001"}),". By default all uploaded assets will be stored in a sub-folder of the OS temp directory (NOTE: they will be lost when the OS clears the temp directory). The default authentication key is ",(0,n.jsx)(t.code,{children:"change_me"}),"."]}),"\n",(0,n.jsx)(t.h2,{id:"overview",children:"Overview"}),"\n",(0,n.jsx)(t.h2,{id:"customized-setup",children:"Customized setup"}),"\n",(0,n.jsxs)(t.p,{children:["The Eik service builds upon ",(0,n.jsx)(t.a,{href:"https://www.fastify.io/",children:"Fastify"})," and is in addition to being a standalone server also exposed as a Fastify plugin. This makes it extremely flexible and easy to set up a custom Eik service."]}),"\n",(0,n.jsx)(t.p,{children:"Example of a custom server using the sink for Google Cloud Storage and extending the HTTP API with custom ready checks:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-js",children:"const fastify = require('fastify');\nconst Service = require('@eik/service');\nconst Sink = require('@eik/sink-gcs');\n\n// Set up the Google Cloud Storage sink\nconst sink = new Sink(...);\n\n// Set up the Eik service as a plugin\nconst service = new Service({ customSink: sink });\n\n// Set up Fastify\nconst app = fastify({\n    ignoreTrailingSlash: true,\n    modifyCoreObjects: false,\n    trustProxy: true,\n});\n\n// Register the Eik service in Fastify\napp.register(service.api());\n\n// Append custom HTTP ready checks\napp.get('/_/health', (request, reply) => {\n    reply.send('ok');\n});\n\napp.get('/_/ready', (request, reply) => {\n    reply.send('ok');\n});\n\n// Start the server\nconst run = async () => {\n    await service.health();\n    await app.listen(service.config.get('http.port'), service.config.get('http.address'));\n}\nrun();\n"})})]})}function u(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}},8453:(e,t,s)=>{s.d(t,{R:()=>a,x:()=>o});var n=s(6540);const i={},r=n.createContext(i);function a(e){const t=n.useContext(r);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),n.createElement(r.Provider,{value:t},e.children)}}}]);